---
title: "**PSY6422 - Project**"
author: "ID: 220251464"
date: '2023-05-16'
output: html_document
---

![](images/drinks_image.png)

<center> 
# **STARBUCKS  &  COSTA COFFEE** 
</center>

#enable github pages (a single clickable link which displays the markdown pages)
#saves key visualisations as files
#code rationale clearly and surcinctly explained

## **Background**
  
### Data Origins
Answering questions of where it comes from, how it was collected, what the variables mean, etc
show the first few rows of the raw data, if possible  
data source fully acknowledged, including details on data collection which are relevant to intepretation
  full permanent citation

### Project Organization

The /data folder contains data required for the project, and /images contains images required for the project, as well as visualization outputs.

A codebook describing all labels and abbrevations used in this project for data, variables, functions etc. within this project is located at /codebook.xlsx.
        
### **Research Questions**
in plain English, a simple statement of what question(s) your visualisation will attempt to address  

## **Data Preparation**
### Loading packages

The project utilized the renv package to retain package versions, safeguarding it from potential updates to packages in the future.

Package versions used in this project are listed within the file /renv.lock

```{r loadlib, echo = TRUE, results = 'hide', warning = FALSE, message = FALSE}
#Load packages with renv
install.packages("renv")
library(renv)
renv::restore()

#Import packages
library(tidyverse)
library(gapminder)
library(ggplot2)
library(png)
library(RCurl)
library(grid)
library(dplyr)
library(scales)
library(showtext)
library(here)  
library(readxl)
library(knitr)
```

## Cleaning the data
steps taken to clean the data, exclude outliers, create summary statistics, grouped variables, etc
show the first few rows of the processed data, if possible
showing the code which does this where relevant  

```{r}.
#Specify image relative paths for logos and legend icons
Starbucks_image <- readPNG((here::here("images", "starbucks_logo.png")), native = TRUE)
Costa_image <- readPNG((here::here("images", "costa_logo.png")), native = TRUE)  

starbucks_cup <- readPNG((here::here("images", "starbucks_cup.png")), native = TRUE)
costa_cup <- readPNG((here::here("images", "costa_cup.png")), native = TRUE)  
```
```{r results = TRUE}
#Read raw data
rawdata <- read_excel(here::here("data","DAAVDATA.xlsx"))
print(rawdata)
``` 

```{r}.
#Create clean dataframe
df <- data.frame(
  Type.of.Coffee = c(rep(DAAVDATA$'Type of coffee', 2)),
  Brand = rep(c("Starbucks" , "Costa"), 14),
  Caffeine = c(DAAVDATA$`Caffeine (mg) Starbucks`, DAAVDATA$`Caffeine (mg) Costa`),
  Volume = c(DAAVDATA$`Volume (mL) Starbucks`, DAAVDATA$`Volume (mL) Costa`))
```  
```{r}.
#Define the desired orders
order_list <- c(1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14)
order_list2 <- c(1, 15, 2, 16, 3, 17, 4, 18, 5, 19, 6, 20, 7, 21, 8, 22, 9, 23, 10, 24, 11, 25, 12, 26, 13, 27, 14, 28)  

#Define a function to reorder a vector based on an order list
reorder_vec <- function(vec, order_list) {
  vec[order_list]}  

#Reorder the columns using the reorder_vec function
df <- df %>%
  mutate(Type.of.Coffee = reorder_vec(Type.of.Coffee, order_list),
         Caffeine = reorder_vec(Caffeine, order_list2), 
         Volume = reorder_vec(Volume, order_list2))  
         
#Specify order of Coffee  
df$Type.of.Coffee <- factor(df$Type.of.Coffee, levels = unique(df$Type.of.Coffee), ordered = TRUE)  
```

```{r results = TRUE}
#Print Clean data frame 
print(df)  
``` 

## **Visualisation**
graph or graphs documentation explaining any motivation (although good graph labelling is better than explanation in the accompanying text)
code for producing them  
alignment between visualisation question(s) and visualisation(s) such that the question is addressed and new insights provided (explains and justifies choice of chart (type,style, etc))

### Colours

Colours of bars in the visualization correspond to iconic colours of the brands, for the Caffeine content, increasing glance value for those familiar with brands. This is important as those most likely to be interested in the data are those familiar with the brands.  Additionally, for better clarity, the bars corresponding to the drink Volume, are coloured coffee-like colours, a light contrast with the Caffeine bars is ensured by slightly fading them and brands are differentiated by the two different hues of brown. 

### Custom Text

Using the showtext package, a personalized text was imported and incorporated into the visualization. The chosen font closely resembles the fonts employed by the two brands, thereby enhancing the professional appearance and overall attractiveness of the visualization.

```{r}.
font_add_google(name = "Source Sans Pro", family = "Source Sans Pro") 
#Load new custom font for showtext package  

showtext_auto()
#Automatically use showtext for plot 
```

### Design

```{r}.
#Plot graph and customize various plot aesthetics
ggp <- ggplot(df, aes(fill=Brand, y=Caffeine, x=Type.of.Coffee)) +   #creating baseplot
  geom_bar(aes(y = Volume / 1,                                       #adding volume barplot
          fill = ifelse(Brand == "Starbucks", "C", "D")),            #specifying seperate bar colours 
          position = "dodge", stat="identity",                       #specifying a grouped barplot
          width = 0.8, alpha=.5,                                     #altering bar width and transparancy, 
          show.legend = FALSE) +                                     #hiding default legend
  geom_bar(aes(fill = ifelse(Brand == "Starbucks", "A", "B")),       #adding caffeine barplot, specifying colours
           position = "dodge", stat = "identity",                    #making it a grouped barplot
           width = 0.5,                                              #narrowing bar width to better see plot bars
           show.legend = FALSE) +                                    #hiding default legend 
  scale_y_continuous(name = "Caffeine (mg)",                         #naming left y-axis
                     breaks = seq(0, 500, by = 50),                  #changing breaks on axis (range, frequency)
                     limits = c(0, 670), expand =c(0,0),             #making space for legends 
                                                                     #and removing space between graph and axis
    sec.axis = sec_axis(~.*1, name="Volume (mL)",                    #adding secondary y-axis 
               breaks = seq(0, 500, by = 50))) +                     #and specyfing axis breaks
  ggtitle("Costa VS Starbucks: Caffeine & Size") +                   #creating the title
  labs(x = "Type of Coffee*",                                        #labelling the x-axis
      subtitle = "Europe & UK, 2023",                                #creating the subtitle 
      caption = "*Takeaway, Standard/Medium Size") +                 #and caption for the x-axis title label      
  scale_fill_manual(values = c("A" = "#1b703f", "B" = "#B91345",     #specifying colours for the types of bars
                               "C" = "#63330b", "D" = "#996633")) +      
  theme(aspect.ratio = 3/5,                                          #setting the proportions of the plot 
        panel.grid.major = element_blank(),                          #removing the plot grid
        panel.grid.minor = element_blank(), 
        panel.background = element_blank(),                          #removing the plot background
        plot.margin = unit(c(1,1,2,1), "cm"),                        #altering the plot margin around the plot
        axis.line = element_line(colour = "black", linewidth = 1),   #changing colour + thickness of axis lines
        axis.text.x = element_text(angle = 50, vjust = 0.5,          #adjusting x-axis break labels: direction,
        hjust = 1, margin = margin(t = -30)),                        #alignment and distance from the axis          
        axis.title.x = element_text(margin = margin(t = 70),         #adjusting x-axis label title: distance
                                    size = 12),                      #from the axis and text size                
        axis.title.y = element_text(margin = margin(r = 15)),        #adjusting left y-axis label: distance       
        axis.title.y.right = element_text(margin = unit              #adjusting right y-axis label: distance 
                                         (c(0, 0, 0, 5), 'mm')),     #(from the axis)                         
        plot.title = element_text(margin = margin(b = 6),            #altering plot title aesthetics: distance,
                     hjust = 0.5, size = 14, face = "bold"),         #alignment, size and making it bold
        plot.subtitle = element_text(margin = margin (b = 20),       #changing subtitle aesthetics: distance,
                        size = 11, hjust = 0.5),                     #size and alignment
        plot.caption = element_text(margin = margin (t = 10),        #altering the captions margin,
                       color = "#6e6e6e", face = "italic",           #color, italicizing 
                       hjust = 0.5)) +                               #and shifting the alignment
#
                                                                     #creating my own legend:        
   annotation_raster(Starbucks_image, xmin = 0.73, xmax = 1.39,       #adding Starbucks logo + coordinates
                                      ymin = 521, ymax = 573) +
   annotation_raster(Costa_image, xmin = 0.491, xmax = 1.63,          #adding Costa logo + coordinates
                                  ymin = 578, ymax = 630) +
   annotation_raster(starbucks_cup, xmin = 13.5, xmax = 14.5,         #adding cup icon for Starbucks Volume 
                                    ymin = 515, ymax = 570) +         #plus coordinates         
   annotation_raster(costa_cup, xmin = 13.5, xmax = 14.5,             #adding cup icon for Costa Volume 
                                ymin = 575, ymax = 630) +             #plus coordinates
   annotate("text", x = 1.7:1.7, y = c(550, 605),                     #adding legend text on the left
            label = c("Starbucks", "Costa"), hjust = 0) +             
   annotate("text", x = 13.5:13.5, y = c(543, 603),                   #adding legend text on the right
            label = c("Starbucks", "Costa"), hjust = 1) +           
   annotate("text", x = 0.8, y = 659, label = "Brand",                #adding legend title on the left
            hjust = 0, fontface = "bold") +                           #(including making it bold)
   annotate("text", x = 14.2, y = 658, label = "Brand Volume",        #adding legend title on the right
            hjust = 1, fontface = "bold")                             #(including making it bold)
```

### Saving Visualisation
```{r eval = FALSE, message = FALSE}
#Save plot to images folder
windows(width = 1000, height = 800) #Open windows graphics device
print(ggp)
dev.print(file = here("images", "StarbucksVSCosta_Graph.png"), device = png, width = 1000, height = 800)
```



### Result
![](images/StarbucksVSCosta_Graph.png)

## Interpretation & Future Direction
Notes on intepretation are provided
Notes on possible extensions or follow-ups are provided

## **Summary**
Brief thoughts on what you have learnt, what you might do next if you had more time / more data  






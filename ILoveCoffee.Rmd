---
title: "PSY6422 Project"
author: "Mathilde Klitgaard"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

----------------------------------------------
#TITLE: I <3 COFFEE
#change rmd file name to Student ID
#enable github pages

#![](Figures/image.png) to insert a photo in RMD file

#Load packages
library(tidyverse)
library(gapminder)
library(ggplot2)
library(png)
library(RCurl)
library(grid)
library(dplyr)

# Specify image paths and create logos
#needs RELATIVE PATH 
Starbucks_image <- readPNG("C:/Users/Mathi/OneDrive/Dokumenter/UNIVERSITY/DAAV Project 2023/DAAVProject/starbucks_logo.png", native = TRUE)
Costa_image <- readPNG("C:/Users/Mathi/OneDrive/Dokumenter/UNIVERSITY/DAAV Project 2023/DAAVProject/costa_logo.png", native = TRUE)

# Print raw dataframe
print(DAAVDATA)

# Create clean dataframe
df <- data.frame(
  Type.of.Coffee = c(rep(DAAVDATA$'Type of coffee', 2)),
  Brand = rep(c("Starbucks" , "Costa"), 14),
  Caffeine = c(DAAVDATA$`Caffeine (mg) Starbucks`, DAAVDATA$`Caffeine (mg) Costa`))
  
# Define the desired orders
order_list <- c(1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14)
order_list2 <- c(1, 15, 2, 16, 3, 17, 4, 18, 5, 19, 6, 20, 7, 21, 8, 22, 9, 23, 10, 24, 11, 25, 12, 26, 13, 27, 14, 28)

# Re-order the column using the order_list
df <- df %>%
  mutate(Type.of.Coffee = Type.of.Coffee[order_list],
  Caffeine = Caffeine[order_list2])

# Print Caffeine data frame
print(df)

# Specify order of Coffee
df$Type.of.Coffee <- factor(df$Type.of.Coffee, levels = unique(df$Type.of.Coffee), ordered = TRUE)

#Create Plot
ggp <- ggplot(df, aes(x = Type.of.Coffee, y = Caffeine)) +
  geom_bar(aes(fill = Brand), position = "dodge", stat = "identity", width = 0.7, show.legend = FALSE) +
    labs(x = "Type of Coffee*", y = "Caffeine (mg)") +
    scale_y_continuous(expand=c(0,0)) +
    scale_fill_manual(values = c("#B91345", "#1b703f")) +
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(), 
          panel.background = element_blank(), 
          axis.line = element_line(colour = "black"), 
          aspect.ratio = 3/5, 
          axis.text.x = element_text(angle = 50, vjust = 0.5,  
          hjust = 1, margin = margin(t = -35)),
          axis.title.x = element_text(margin = margin(t = 43)),
          axis.title.y = element_text(margin = margin(r = 15))) +
  annotation_raster(Starbucks_image, xmin = 0.72, xmax = 1.57, 
    ymin = 257,
    ymax = 285) +
  annotation_raster(Costa_image, xmin = 0.481, xmax = 1.8, 
    ymin = 290,
    ymax = 320) +
  annotate("text", x = 2:2, y = c(271, 305), label = c("Starbucks", "Costa"), hjust = 0) +
  ggtitle("Costa VS Starbucks: Caffeine & Size") +
    labs(subtitle = "Europe & UK, 2023") +
      theme(plot.title = element_text(margin = margin(b = 6), hjust = 0.5),
            plot.subtitle = element_text(margin = margin
            (b = 20), size = 9, hjust = 0.5),
            plot.margin = unit(c(1,1,2,1), "cm"))

# Create the second data frame
df2 <- data.frame(select(df, Type.of.Coffee), select(df, Brand), Volume = c(DAAVDATA$`Volume (mL) Starbucks`, DAAVDATA$`Volume (mL) Costa`))

Volume <- df2$Volume

# Re-order the column using the order_list
df2 <- df2 %>%
  mutate(Volume = Volume[order_list2])

# Print Volume data frame
print(df2)

# Specify order of Coffee
df2$Type.of.Coffee <- factor(df2$Type.of.Coffee, levels = unique(df2$Type.of.Coffee), ordered = TRUE)

# Add the second barplot with the second y-axis
ggp <- ggp + geom_bar(data = df2, aes(x = Type.of.Coffee, y = Volume, fill = Brand), position = "dodge", stat = "identity", alpha = 0.5)

# Display the plot
ggp

#*TAKEAWAY, STANDARD OR MEDIUM SIZE
